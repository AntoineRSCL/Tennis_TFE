{# templates/tournament/index.html.twig #}

{% extends 'base.html.twig' %}

{% block body %}
<div class="tournamentContainer">
    <div class="listTournament">
    
        <h1>Liste des Tournois</h1>

        {# Section pour afficher les messages flash #}
        {% for label, messages in app.flashes %}
            <div class="alert alert-{{ label }}">
                {% for message in messages %}
                    <p>{{ message }}</p>
                {% endfor %}
            </div>
        {% endfor %}

        {# Boucle pour afficher tous les tournois #}
        {% for tournament in tournaments %}
            <div class="tournament">
                <h3>{{ tournament.name }}</h3>
                <p>Statut : {{ tournament.status }}</p>
                
                {# Si le tournoi est en phase d'inscription, afficher le bouton d'inscription #}
                {% if tournament.status == 'inscription' %}
                    {# Vérifier si l'utilisateur est déjà inscrit #}
                    {% if not tournamentRegistrations[tournament.id] %}
                        <a href="{{ path('tournament_register', { id: tournament.id }) }}" class="btn btn-primary">S'inscrire</a>
                    {% else %}
                        <a href="{{ path('tournament_unregister', { id: tournament.id }) }}" class="btn btn-warning">Se désinscrire</a>
                    {% endif %}
                {% else %}
                    {# Le tournoi est soit en cours soit terminé, afficher les tableaux #}
                    <a href="{{ path('tournament_view_bracket', { id: tournament.id }) }}" class="btn btn-info">Voir les tableaux</a>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>

{% endblock %}
